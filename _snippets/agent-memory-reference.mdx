### 参数

| 参数 | 类型 | 描述 | 默认值 |
|---|---|---|---|
| `model` | `Optional[Model]` | 用于记忆和摘要的模型 | `None` |
| `memory_manager` | `Optional[MemoryManager]` | 记忆操作管理器 | `None` |
| `summarizer` | `Optional[SessionSummarizer]` | 用于生成会话摘要的摘要器 | `None` |
| `db` | `Optional[MemoryDb]` | 用于存储记忆的数据库 | `None` |
| `debug_mode` | `bool` | 是否启用调试日志记录 | `False` |

### 主要方法

#### 用户记忆管理

| 方法 | 描述 | 参数 | 返回值 |
|---|---|---|---|
| `get_user_memories` | 检索用户的所有记忆 | `user_id: str` | `List[UserMemory]` |
| `get_user_memory` | 获取特定记忆 | `user_id: str, memory_id: str` | `UserMemory` |
| `add_user_memory` | 添加新记忆并获取记忆 ID | `memory: UserMemory, user_id: Optional[str] = None` | `str` |
| `replace_user_memory` | 更新现有记忆并获取记忆 ID | `memory_id: str, memory: UserMemory, user_id: Optional[str] = None` | `str` |
| `delete_user_memory` | 删除记忆 | `user_id: str, memory_id: str` | `None` |
| `create_user_memories` | 从一条或多条消息创建记忆 | `message: Optional[str] = None, messages: Optional[List[Message]] = None, user_id: Optional[str] = None` | `str` |
| `acreate_user_memories` | 从一条或多条消息创建记忆 (异步) | `message: Optional[str] = None, messages: Optional[List[Message]] = None, user_id: Optional[str] = None` | `str` |
| `search_user_memories` | 使用指定的检索方法搜索用户记忆 | `query: Optional[str] = None, limit: Optional[int] = None, retrieval_method: Optional[Literal["last_n", "first_n", "semantic"]] = None, user_id: Optional[str] = None` | `List[UserMemory]` |

#### 会话摘要管理

| 方法 | 描述 | 参数 |
|---|---|---|
| `get_session_summaries` | 检索用户的所有会话摘要 | `user_id: str` |
| `get_session_summary` | 获取特定会话摘要 | `user_id: str, session_id: str` |
| `create_session_summary` | 从已存储的会话运行创建会话摘要 | `session_id: str, user_id: Optional[str] = None` |
| `acreate_session_summary` | 从已存储的会话运行创建会话摘要 (异步) | `session_id: str, user_id: Optional[str] = None` |
| `delete_session_summary` | 删除会话摘要 | `user_id: str, session_id: str` |

### UserMemory

| 参数 | 类型 | 描述 | 默认值 |
|---|---|---|---|
| `memory` | `str` | 实际的记忆内容 | 必需 |
| `topics` | `Optional[List[str]]` | 记忆的主题或类别 | `None` |
| `input` | `Optional[str]` | 生成此记忆的原始输入 | `None` |
| `last_updated` | `Optional[datetime]` | 记忆上次更新时间 | `None` |
| `memory_id` | `Optional[str]` | 记忆的唯一标识符 | `None` |

### SessionSummary

| 参数 | 类型 | 描述 | 默认值 |
|---|---|---|---|
| `summary` | `str` | 会话的简洁摘要 | 必需 |
| `topics` | `Optional[List[str]]` | 会话中讨论的主题 | `None` |
| `last_updated` | `Optional[datetime]` | 摘要上次更新时间 | `None` |

### Memory Manager

| 参数 | 类型 | 描述 | 默认值 |
|---|---|---|---|
| `model` | `Optional[Model]` | 用于管理记忆的模型 | `None` |
| `system_message` | `Optional[str]` | 记忆管理器的自定义系统提示 | `None` |
| `additional_instructions` | `Optional[str]` | 添加到系统消息末尾的附加说明 | `None` |

### Session Summarizer

| 参数 | 类型 | 描述 | 默认值 |
|---|---|---|---|
| `model` | `Optional[Model]` | 用于摘要会话的模型 | `None` |
| `system_message` | `Optional[str]` | 摘要器的自定义系统提示 | `None` |
| `additional_instructions` | `Optional[str]` | 添加到系统消息末尾的附加说明 | `None` |