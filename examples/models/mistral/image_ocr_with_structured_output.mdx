---
title: 使用结构化输出的图像 OCR
description: 使用 OCR 功能从图像中提取结构化数据的示例
---

## 概述
此示例演示了如何使用 Mistral 的视觉模型对图像执行 OCR，并使用 Pydantic 模型将提取的信息以结构化格式返回。

## 代码

```python cookbook/models/mistral/image_ocr_with_structured_output.py
from typing import List

from pydantic import BaseModel
from agno.agent import Agent
from agno.media import Image
from agno.models.mistral.mistral import MistralChat

# 定义提取信息的结构化数据
class GroceryItem(BaseModel):
    item_name: str
    price: float

class GroceryListElements(BaseModel):
    bill_number: str
    items: List[GroceryItem]
    total_price: float

agent = Agent(
    model=MistralChat(id="pixtral-12b-2409"),
    instructions=[
        "从图片中提取用户描述的文本元素",
    ],
    response_model=GroceryListElements,
    markdown=True,
)

# 处理图像并提取结构化数据
agent.print_response(
    "从这张餐厅账单中，提取账单号、项目名称和相关价格，以及总价，并将其作为 Json 对象中的字符串返回",
    images=[
        Image(url="https://i.imghippo.com/files/kgXi81726851246.jpg")
    ],
)
```

## 用法

<Steps>
  <Snippet file="create-venv-step.mdx" />

  <Step title="设置你的 API 密钥">
    ```bash
    export MISTRAL_API_KEY=xxx
    ```
  </Step>

  <Step title="安装库">
    ```bash
    pip install -U mistralai agno
    ```
  </Step>

  <Step title="运行 Agent">
    <CodeGroup>
    ```bash Mac
    python cookbook/models/mistral/image_ocr_with_structured_output.py
    ```

    ```bash Windows
    python cookbook/models/mistral/image_ocr_with_structured_output.py
    ```
    </CodeGroup>
  </Step>
</Steps>