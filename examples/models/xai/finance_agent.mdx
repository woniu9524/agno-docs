---
title: 金融代理
---

## 代码

```python cookbook/models/xai/finance_agent.py
"""🗞️ 金融代理 - 您的个人市场分析师！

本示例展示如何创建一个复杂的金融分析师，该分析师利用实时数据提供全面的市场洞察。该代理结合了股市数据、分析师推荐、公司信息和最新新闻，以提供专业级的金融分析。

可以尝试的示例提示：
- "苹果公司 (AAPL) 的最新新闻和财务表现如何？"
- "请详细分析特斯拉 (TSLA) 当前的市场地位"
- "微软 (MSFT) 的财务状况如何？请包含分析师的推荐意见"
- "分析英伟达 (NVDA) 的股票表现和未来展望"
- "市场对亚马逊 (AMZN) 最新季报有什么看法？"

运行：`pip install openai yfinance agno` 来安装依赖项
"""

from textwrap import dedent

from agno.agent import Agent
from agno.models.xai import xAI
from agno.tools.yfinance import YFinanceTools

finance_agent = Agent(
    model=xAI(id="grok-3-mini-beta"),
    tools=[
        YFinanceTools(
            stock_price=True,
            analyst_recommendations=True,
            stock_fundamentals=True,
            historical_prices=True,
            company_info=True,
            company_news=True,
        )
    ],
    instructions=dedent("""\
        你是一位经验丰富的华尔街分析师，精通市场分析！📊

        请遵循以下步骤进行全面的财务分析：
        1. 市场概览
           - 最新股价
           - 52周最高价和最低价
        2. 财务深度剖析
           - 关键指标（市盈率、市值、每股收益）
        3. 专业洞察
           - 分析师推荐详情
           - 近期评级变动

        4. 市场背景
           - 行业趋势和定位
           - 竞争分析
           - 市场情绪指标

        你的报告风格：
        - 以执行摘要开头
        - 使用表格展示数据
        - 包含清晰的章节标题
        - 使用表情符号指示趋势（📈 📉）
        - 使用要点突出关键见解
        - 将指标与行业平均水平进行比较
        - 包括技术术语解释
        - 以前瞻性分析结束

        风险披露：
        - 始终强调潜在风险因素
        - 注意市场不确定性
        - 提及相关的监管担忧
    """),
    add_datetime_to_instructions=True,
    markdown=True,
)

# 使用详细市场分析请求的示例用法
finance_agent.print_response(
    "撰写一份关于 TSLA 的综合报告",
    stream=True,
    stream_intermediate_steps=True,
)
```

## 用法

<Steps>
  <Snippet file="create-venv-step.mdx" />

  <Step title="设置您的 API 密钥">
    ```bash
    export XAI_API_KEY=xxx
    ```
  </Step>

  <Step title="安装库">
    ```bash
    pip install -U openai yfinance agno
    ```
  </Step>

  <Step title="运行代理">
    ```bash
    python cookbook/models/xai/finance_agent.py
    ```
  </Step>
</Steps>