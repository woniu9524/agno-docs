---
title: Agent 额外指标
---

此示例展示了如何获取特殊的 token 指标，例如音频、缓存和推理 token。

## 代码

```python cookbook/agent_concepts/other/agent_extra_metrics.py
import requests
from agno.agent import Agent
from agno.media import Audio
from agno.models.openai import OpenAIChat

# 获取音频文件并将其转换为 base64 编码字符串
url = "https://openaiassets.blob.core.windows.net/$web/API/docs/audio/alloy.wav"
response = requests.get(url)
response.raise_for_status()
wav_data = response.content

agent = Agent(
    model=OpenAIChat(
        id="gpt-4o-audio-preview",
        modalities=["text", "audio"],
        audio={"voice": "sage", "format": "wav"},
    ),
    markdown=True,
    debug_mode=True,
)
agent.print_response(
    "What's in these recording?",
    audio=[Audio(content=wav_data, format="wav")],
)
# 显示输入音频、输出音频和总音频 token 指标
print(f"Input audio tokens: {agent.run_response.metrics['input_audio_tokens']}")
print(f"Output audio tokens: {agent.run_response.metrics['output_audio_tokens']}")
print(f"Audio tokens: {agent.run_response.metrics['audio_tokens']}")

agent = Agent(
    model=OpenAIChat(id="o3-mini"),
    markdown=True,
    telemetry=False,
    monitoring=False,
    debug_mode=True,
)
agent.print_response(
    "Solve the trolley problem. Evaluate multiple ethical frameworks. Include an ASCII diagram of your solution.",
    stream=False,
)
# 显示推理 token 指标
print(f"Reasoning tokens: {agent.run_response.metrics['reasoning_tokens']}")


agent = Agent(
    model=OpenAIChat(id="gpt-4o-mini"), markdown=True, telemetry=False, monitoring=False
)
agent.run("Share a 2 sentence horror story" * 150)
agent.print_response("Share a 2 sentence horror story" * 150)
# 显示缓存 token 指标
print(f"Cached tokens: {agent.run_response.metrics['cached_tokens']}")
```

## 用法

<Steps>
  <Snippet file="create-venv-step.mdx" />

  <Step title="设置你的 API 密钥">
    ```bash
    export OPENAI_API_KEY=xxx
    ```
  </Step>

  <Step title="安装库">
    ```bash
    pip install -U requests openai agno
    ```
  </Step>

  <Step title="运行 Agent">
    <CodeGroup>
    ```bash Mac
    python cookbook/agent_concepts/other/agent_extra_metrics.py
    ```

    ```bash Windows
    python cookbook/agent_concepts/other/agent_extra_metrics.py
    ```
    </CodeGroup>
  </Step>
</Steps>